---
# tasks file for role-ssh
- name: SSH | Ensure OpenSSH was installed on {{ ansible_facts['distribution'] }}
  ansible.builtin.package:
    name: openssh-server
    state: present

- include_tasks: configure_ssh.yml
  loop: "{{ ssh_default_user }}"
  loop_control:
    loop_var: ssh_user
  no_log: yes
  when:
    - ssh_root_private_key != ""
    - ssh_default_user != "{}"

- include_tasks: configure_ssh.yml
  loop: "{{ ssh_users }}"
  loop_control:
    loop_var: ssh_user
  no_log: yes
  when: ssh_users != "{}"
